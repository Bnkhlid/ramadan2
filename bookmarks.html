<!doctype html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>رمضان كريم | المفضلة</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Tajawal:wght@300;400;500;700;800&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/main.js?v=ramadan2"></script>
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="bg-ramadan-dark text-white font-tajawal">
    <div id="nav-placeholder"></div>

    <section id="bookmarks" class="py-24 min-h-screen relative overflow-hidden">
        <div class="absolute inset-0 stars opacity-30"></div>
        <div class="absolute inset-0 islamic-pattern opacity-10"></div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-12">
                <span class="text-ramadan-gold text-sm font-bold tracking-wider">قائمة المفضلة</span>
                <h2 class="text-4xl lg:text-6xl font-bold mt-2 font-amiri text-white">آيات وأحاديث مختارة</h2>
            </div>

            <div class="max-w-4xl mx-auto space-y-12">
                <!-- Quran Bookmarks Section -->
                <div>
                    <h3 class="text-2xl font-bold text-ramadan-gold mb-6 flex items-center gap-3">
                        <i class="fas fa-book-quran"></i> الآيات القرآنية
                    </h3>
                    <div id="quranBookmarks" class="grid gap-6">
                        <!-- Bookmarks will be injected here -->
                    </div>
                </div>

                <hr class="border-white/10">

                <!-- Hadith Bookmarks Section -->
                <div>
                    <h3 class="text-2xl font-bold text-ramadan-gold mb-6 flex items-center gap-3">
                        <i class="fas fa-book-open"></i> الأحاديث النبوية
                    </h3>
                    <div id="hadithBookmarks" class="grid gap-6">
                        <!-- Bookmarks will be injected here -->
                    </div>
                </div>

                <div id="emptyState" class="hidden text-center py-20 text-gray-400">
                    <i class="far fa-heart text-6xl mb-4 opacity-20"></i>
                    <p class="text-xl">لا توجد عناصر في المفضلة بعد</p>
                    <div class="mt-6 flex justify-center gap-4">
                        <a href="quran.html"
                            class="px-6 py-2 bg-ramadan-gold/10 text-ramadan-gold rounded-full hover:bg-ramadan-gold/20 transition-all border border-ramadan-gold/30">اقرأ
                            القرآن</a>
                        <a href="hadith.html"
                            class="px-6 py-2 bg-ramadan-gold/10 text-ramadan-gold rounded-full hover:bg-ramadan-gold/20 transition-all border border-ramadan-gold/30">اقرأ
                            الأحاديث</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="footer-placeholder"></div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            injectNav('bookmarks');
            injectFooter();
            renderBookmarks();
        });

        function getBookmarks() {
            return JSON.parse(localStorage.getItem('ramadan_bookmarks') || '[]');
        }

        function renderBookmarks() {
            const bookmarks = getBookmarks();
            const qContainer = document.getElementById('quranBookmarks');
            const hContainer = document.getElementById('hadithBookmarks');
            const emptyState = document.getElementById('emptyState');

            qContainer.innerHTML = '';
            hContainer.innerHTML = '';

            const quranBms = bookmarks.filter(b => b.type === 'quran');
            const hadithBms = bookmarks.filter(b => b.type === 'hadith');

            if (bookmarks.length === 0) {
                emptyState.classList.remove('hidden');
            } else {
                emptyState.classList.add('hidden');
            }

            // Render Quran
            if (quranBms.length === 0) {
                qContainer.innerHTML = '<p class="text-gray-500 italic text-center py-4 bg-white/5 rounded-xl border border-dashed border-white/10">لم تقم بحفظ أي آيات بعد</p>';
            } else {
                quranBms.forEach((b) => {
                    const div = document.createElement('div');
                    div.className = "glass-effect p-6 rounded-xl border-t-2 border-ramadan-gold relative group";
                    div.innerHTML = `
                        <button onclick="removeBookmark('quran', ${b.suraNumber}, ${b.ayahNumber})" 
                                class="absolute top-2 left-2 text-red-500 hover:scale-110 transition-transform p-2" 
                                title="حذف من المفضلة">
                            <i class="fas fa-trash-can"></i>
                        </button>
                        <p class="text-xl font-amiri leading-loose mb-4 text-white hover:text-ramadan-gold transition-colors">${b.text}</p>
                        <div class="flex justify-between items-center text-xs text-ramadan-gold">
                             <span class="bg-ramadan-gold/10 px-3 py-1 rounded-full border border-ramadan-gold/20">
                                سورة ${b.suraName} - آية ${b.ayahNumber}
                             </span>
                             <a href="quran.html" onclick="localStorage.setItem('lastSura', ${b.suraNumber - 1});" class="hover:underline text-gray-400">انتقال للمصحف <i class="fas fa-arrow-left mr-1"></i></a>
                        </div>
                    `;
                    qContainer.appendChild(div);
                });
            }

            // Render Hadith
            if (hadithBms.length === 0) {
                hContainer.innerHTML = '<p class="text-gray-500 italic text-center py-4 bg-white/5 rounded-xl border border-dashed border-white/10">لم تقم بحفظ أي أحاديث بعد</p>';
            } else {
                hadithBms.forEach((b) => {
                    const div = document.createElement('div');
                    div.className = "glass-effect p-6 rounded-xl border-r-4 border-ramadan-gold relative group";
                    div.innerHTML = `
                        <button onclick="removeBookmark('hadith', '${b.collection}', '${b.id}')" 
                                class="absolute top-4 left-4 text-red-500 hover:scale-110 transition-transform p-2" 
                                title="حذف من المفضلة">
                            <i class="fas fa-trash-can"></i>
                        </button>
                        <p class="text-lg font-amiri leading-loose text-gray-100 mb-3">${b.text}</p>
                        <div class="flex justify-between items-center text-xs text-gray-400">
                            <span class="bg-white/5 px-3 py-1 rounded border border-white/10">المصدر: ${b.collectionName} - رقم ${b.id}</span>
                        </div>
                    `;
                    hContainer.appendChild(div);
                });
            }
        }

        function removeBookmark(type, id1, id2) {
            let bookmarks = getBookmarks();
            let index = -1;
            if (type === 'quran') {
                index = bookmarks.findIndex(b => b.type === 'quran' && b.suraNumber === id1 && b.ayahNumber === id2);
            } else {
                index = bookmarks.findIndex(b => b.type === 'hadith' && b.collection === id1 && b.id === id2);
            }

            if (index > -1) {
                bookmarks.splice(index, 1);
                localStorage.setItem('ramadan_bookmarks', JSON.stringify(bookmarks));
                renderBookmarks();
            }
        }
    </script>
</body>

</html>